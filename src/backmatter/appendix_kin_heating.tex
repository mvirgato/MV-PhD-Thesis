%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Kinetic Heating}
\label{appendix:kin_heating}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Procedure for calculating kinetic heating time}

\begin{itemize}
    \item Select a point in the star for the DM to scatter off, $r_{\rm scatter, 0}$. 
    \item DM comes in from infinity with initial energy $E_\chi \approx m_\chi$
    \item Boost DM to local energy of $m_\chi/\sqrt{B(r_{\rm scatter})}$
    \item Scatter the DM and calculate initial $\Delta E_\chi$
    \item Set local DM energy to $E_\chi \equiv p^t = m_\chi/\sqrt{B(r_{\rm scatter})} - \Delta E_\chi$
    \item Calculate the new conserved energy per unit mass along the orbit as 
    \begin{equation}
        \tilde E_\chi^{\rm orbit} = \sqrt{B(r_{\rm scatter})}E_\chi/m_\chi = \frac{\sqrt{B(r_{\rm scatter})}}{ m_\chi} (m_\chi/\sqrt{B(r_{\rm scatter, 0})} - \Delta E_\chi)
    \end{equation}
    \item Use Equation~\ref{eq:maxradgeneral} to solve for the maximum radius of the orbit, $R_{\rm orbit}$. 
    \item Use equations~\ref{eq:timeinside} and~\ref{eq:timeoutside} to calculate $T_{\rm in} / (T_{\rm in} + T_{\rm out})$
    \item Adjust the time interval between scatter by $dt\rightarrow dt (T_{\rm in} / (T_{\rm in} + T_{\rm out}))^{-1}$
    \item Iterate until $R_{\rm orbit} < R_\star$
\end{itemize}